# Description
This directory includes the CO2-brine optimization case with a new objective type. The base model is
jointly optimized with well placement and well control. The optimization has been tested to run
successfully in Ubuntu 22.04 environment.

# Tables of content
- [Introduction](#Introduction)
- [Features](#Features)
- [Installation](#Installation)
- [Usage](#Usage)
- [Contact](#Contact)

# Introduction
This case is based on the simulation of CO2 flow behavior. It demonstrates that
FieldOpt now supports the optimization work with the "ExternalResult" objective type — a new methods
that enable the objective function value calculation outside the Field framework.
The initial configuration of the JSON driver file could be adjusted to improve the post-run optimal result.

# Features

The model:
- **The tilt cubic model** : the model grid is a 10×10×15 tilting cube geometry.
- **The random Field generation** : the permeability and porosity value are
  generated by an isotropic Gaussian covariance model.

The Python file directory :
- **The Objective function class** : \
  A Python class uses `resdata` package to post-process the simulation
  result, the child class - NPV calculation - is coded for general net present value calculation.
- **The Objective function case** :
    1) This Python case file contains a tuple data structure - a variable to
       store the NPV component argument, such as well name, data type, fluid price, etc.
    2) The case NPV is calculated by the objective function class.
    3) The Python file takes the optimized case UNSMARY file path and external objective
       result file path as arguments and store the value into a txt file.
- **Path handler** : \
  The objective function result file path is the key argument to run the example.
    1) The path handler Python script takes two arguments as input:
        1) The JSON driver file path
        2) (optimization) output directory path
    2) The path handler mainly works to:
        1) creates the objective function result file under the output directory.
        2) assign the external objective function result file path argument into the JSON drive file.

# Installation
The Python package `resdata` (<https://github.com/equinor/resdata>) needs to be installed before
running the example. By default, the FieldOpt has been `compiled`,
and  `python3` interpreter and python package installer `pip` has been configured already.
``` bash
# Install the resdata package with pip
pip install resdata
```

# Usage
The `run_example_Python` script facilitates the running of this case. The
`base_bash` is added a new line to execute the objection function calculation by python3
interpreter.The objective case python  
Before running the example, the compiled FieldOpt has to be linked in the "\bin" folder.

```bash
# running the example with GA algorithm 
bash run_example_Python.sh GA PythonFile/
```
```bash
# running the example with PSO algorithm 
bash run_example_Python.sh PSO PythonFile/
```

# Contact
This example is part of the master's project by Wang Hou (wang.hou@ntnu.no). All the data is open-source
and free to be used and modified.

